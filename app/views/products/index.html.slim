.header-row
	.search
		= form_tag products_path, method: 'get', data: { behavior: 'search-form' }, class: 'search-form' do
			= select_tag :q, options_for_select(ActsAsTaggableOn::Tag.all, params[:q]), { class: 'search-input', multiple: true, data: { behavior: 'search' }}
			= submit_tag 'Search', name: nil, hidden: true

.grid#grid.is-loading
	- unless signed_in?
		.grid-item
			= render 'shared/signup_cta'
	- @products.each do |product|
		.grid-item
			= render 'products/feed_product', product: product

javascript:
	$('#grid').imagesLoaded( function() {

		function getWindowWidth() {
      return Math.max(document.documentElement.clientWidth, window.innerWidth || 0)
    }
		
		$('#grid').wookmark({
		  itemWidth: function () {
        return getWindowWidth() < 480 ? 300 : 360;
      },
		  offset: 0,
		  flexibleWidth: function () {
        return getWindowWidth() < 480 ? '100%' : 480;
      }
		});

		$('#grid').removeClass('is-loading');
	});

	$(document).ready(function () {
		$("[data-behavior='search']").select2({
			placeholder: 'Discover by hashtag..',
			tags: true
		});
	});

	$("[data-behavior='search']").on('select2:select', function(e) {
		$("[data-behavior='search-form']").submit();
	});